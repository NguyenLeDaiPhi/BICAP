<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>H·ªì s∆° c√° nh√¢n - BiCap</title>
    <link rel="stylesheet" href="/css/style.css" />
</head>
<body class="bg-gray-100">

    <%- include('partials/header') %>

    <div class="container py-4" style="margin-top: 70px;">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3 mb-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="bg-success text-white d-flex align-items-center justify-content-center mx-auto mb-3" 
                             style="width: 80px; height: 80px; border-radius: 50%; font-size: 2rem; font-weight: bold;">
                            <%= typeof user !== 'undefined' && user ? user.username.charAt(0).toUpperCase() : 'U' %>
                        </div>
                        <h5 class="font-weight-bold mb-1"><%= typeof user !== 'undefined' && user ? user.username : 'Ng∆∞·ªùi d√πng' %></h5>
                        <p class="text-muted small mb-3"><%= typeof user !== 'undefined' && user ? user.email : '' %></p>
                        <span class="badge bg-success-subtle text-success">
                            <%= typeof user !== 'undefined' && user && user.role ? user.role : 'GUEST' %>
                        </span>
                    </div>
                    <hr class="m-0">
                    <div class="p-3">
                        <nav class="nav flex-column">
                            <a class="nav-link text-dark d-flex align-items-center py-2" href="/">
                                üè† Trang ch·ªß
                            </a>
                            <a class="nav-link text-dark d-flex align-items-center py-2" href="/market">
                                üè™ S√†n giao d·ªãch
                            </a>
                            <a class="nav-link text-success font-weight-bold d-flex align-items-center py-2" href="/profile">
                                üë§ H·ªì s∆° c√° nh√¢n
                            </a>
                            <a class="nav-link text-danger d-flex align-items-center py-2" href="/auth/logout">
                                üö™ ƒêƒÉng xu·∫•t
                            </a>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-9">
                <!-- Profile Header -->
                <div class="card border-0 shadow-sm mb-4" style="background: linear-gradient(135deg, #E8F5E9, #C8E6C9);">
                    <div class="card-body p-4">
                        <h4 class="font-weight-bold mb-1">üë§ H·ªì S∆° C√° Nh√¢n</h4>
                        <p class="text-muted mb-0">Qu·∫£n l√Ω th√¥ng tin t√†i kho·∫£n v√† y√™u c·∫ßu vai tr√≤</p>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="row g-3 mb-4">
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm text-center p-3">
                            <span style="font-size: 2rem;">üì¶</span>
                            <h4 class="font-weight-bold text-success mb-0">0</h4>
                            <small class="text-muted">ƒê∆°n h√†ng</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm text-center p-3">
                            <span style="font-size: 2rem;">üì±</span>
                            <h4 class="font-weight-bold text-success mb-0">0</h4>
                            <small class="text-muted">L·∫ßn truy xu·∫•t</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm text-center p-3">
                            <span style="font-size: 2rem;">‚≠ê</span>
                            <h4 class="font-weight-bold text-success mb-0">0</h4>
                            <small class="text-muted">ƒê√°nh gi√°</small>
                        </div>
                    </div>
                </div>

                <!-- User Info Form -->
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-white border-0 py-3">
                        <h5 class="mb-0 font-weight-bold">üìã Th√¥ng tin c√° nh√¢n</h5>
                    </div>
                    <div class="card-body">
                        <form>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label text-muted small">H·ªç v√† t√™n</label>
                                    <input type="text" class="form-control bg-gray-100 border-0" 
                                           value="<%= typeof user !== 'undefined' && user ? user.fullName || '' : '' %>" 
                                           placeholder="Nh·∫≠p h·ªç v√† t√™n">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label text-muted small">Email</label>
                                    <input type="email" class="form-control bg-gray-100 border-0" 
                                           value="<%= typeof user !== 'undefined' && user ? user.email || '' : '' %>" 
                                           readonly>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label text-muted small">S·ªë ƒëi·ªán tho·∫°i</label>
                                    <input type="tel" class="form-control bg-gray-100 border-0" 
                                           value="<%= typeof user !== 'undefined' && user ? user.phone || '' : '' %>" 
                                           placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label text-muted small">ƒê·ªãa ch·ªâ</label>
                                    <input type="text" class="form-control bg-gray-100 border-0" 
                                           value="<%= typeof user !== 'undefined' && user ? user.address || '' : '' %>" 
                                           placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-bicap">üíæ L∆∞u thay ƒë·ªïi</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Role Request Form -->
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white border-0 py-3">
                        <h5 class="mb-0 font-weight-bold">üìù Y√™u c·∫ßu vai tr√≤</h5>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info border-0 d-flex">
                            <span style="font-size: 1.5rem; margin-right: 12px;">üí°</span>
                            <div>
                                <strong>B·∫°n mu·ªën tr·ªü th√†nh ƒë·ªëi t√°c?</strong>
                                <p class="mb-0 small">ƒêƒÉng k√Ω vai tr√≤ N√¥ng d√¢n, Nh√† b√°n l·∫ª ho·∫∑c ƒê∆°n v·ªã v·∫≠n chuy·ªÉn ƒë·ªÉ tham gia h·ªá sinh th√°i BiCap.</p>
                            </div>
                        </div>
                        
                        <form action="/api/role-request" method="POST" enctype="multipart/form-data">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label text-muted small">Vai tr√≤ mu·ªën ƒëƒÉng k√Ω</label>
                                    <select name="requestedRole" class="form-control bg-gray-100 border-0" required>
                                        <option value="">-- Ch·ªçn vai tr√≤ --</option>
                                        <option value="FARMER">üåæ N√¥ng d√¢n / Ch·ªß trang tr·∫°i</option>
                                        <option value="RETAILER">üè™ Nh√† b√°n l·∫ª</option>
                                        <option value="SHIPPER">üöö ƒê∆°n v·ªã v·∫≠n chuy·ªÉn</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label text-muted small">T√™n doanh nghi·ªáp / Trang tr·∫°i</label>
                                    <input type="text" name="businessName" class="form-control bg-gray-100 border-0" 
                                           placeholder="Nh·∫≠p t√™n doanh nghi·ªáp" required>
                                </div>
                                <div class="col-12">
                                    <label class="form-label text-muted small">M√¥ t·∫£ ho·∫°t ƒë·ªông</label>
                                    <textarea name="description" class="form-control bg-gray-100 border-0" rows="3" 
                                              placeholder="M√¥ t·∫£ ng·∫Øn v·ªÅ ho·∫°t ƒë·ªông kinh doanh c·ªßa b·∫°n..." required></textarea>
                                </div>
                                <div class="col-12">
                                    <label class="form-label text-muted small">Gi·∫•y ph√©p kinh doanh (PDF, JPG, PNG)</label>
                                    <div class="border-dashed rounded p-4 text-center bg-gray-100" 
                                         style="border: 2px dashed #dee2e6; cursor: pointer;"
                                         onclick="document.getElementById('licenseFile').click()">
                                        <span style="font-size: 2rem;">üìÑ</span>
                                        <p class="mb-0 text-muted small">K√©o th·∫£ file ho·∫∑c click ƒë·ªÉ ch·ªçn</p>
                                        <input type="file" id="licenseFile" name="license" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                    </div>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-bicap">üì§ G·ª≠i y√™u c·∫ßu</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <%- include('partials/footer') %>
</body>
</html>
